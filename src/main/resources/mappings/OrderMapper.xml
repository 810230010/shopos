<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wuliangit.shopos.dao.OrderMapper" >

    <!--获取合并的订单-->
    <select id="getOrderByOutTradeNoMerge" resultType="com.wuliangit.shopos.entity.Order">
        select * from t_order where out_trade_no_merge = #{outTradeNo}
    </select>

    <!--获取当个订单-->
    <select id="getOrderByOutTradeNo" resultType="com.wuliangit.shopos.entity.Order">
        select * from t_order where out_trade_no = #{outTradeNo}
    </select>

    <!--商铺获取订单列表数据-->
    <select id="getStoreOrderList" resultType="com.wuliangit.shopos.dto.StoreOrderListDTO">
        SELECT order_id,out_trade_no,member_name,member_email,order_amount,order_state,carriage_name
        FROM t_order
        <where>
            delete_state = "NO"
            <if test="type != null and type != '' ">
                and ( order_state = #{type})
            </if>
            <if test="searchKey != null and searchKey != '' ">
                and ( out_trade_no like '%${searchKey}%')
            </if>
        </where>
        order by
        <if test="orderColumn != null and orderColumn !='' and orderType != null and orderType != '' ">
            ${orderColumn} ${orderType},
        </if>
        create_time desc
    </select>

    <!--api接口获取订单-->
    <select id="apiGetOrderByStateAndMemberId" resultType="com.wuliangit.shopos.dto.ApiOrderDTO">
        select * from t_order where order_state = #{orderState} and member_id = #{memberId} order by create_time desc
    </select>

    <!--api接口获取所有订单-->
    <select id="apiGetOrderByMemberId" resultType="com.wuliangit.shopos.dto.ApiOrderDTO">
        select * from t_order where member_id = #{memberId} order by create_time desc
    </select>
</mapper>