<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wuliangit.shopos.dao.RefundMapper" >
    <!--审核退换货的申请-->
    <update id="checkRefundApply">
      UPDATE t_refund
      SET seller_state = #{sellerState}
      where refund_id = #{refundId}
    </update>

    <!--获取退换货申请列表的数据-->
    <select id="getApplyRefundList" resultType="com.wuliangit.shopos.dto.StoreRefundListDTO">
        SELECT refund_id,order_sn,refund_sn,member_name,goods_name,reason_info,refund_type
        FROM t_refund
        <where>
            seller_state = "CHECKING" AND refund_state = "ING"
            <if test="searchKey != null and searchKey != '' ">
                and ( member_name like '%${searchKey}%' or goods_name like '%${searchKey}%')
            </if>
        </where>
        order by
        <if test="orderColumn != null and orderColumn !='' and orderType != null and orderType != '' ">
            ${orderColumn} ${orderType},
        </if>
        create_time desc
    </select>

    <!--获取成功申请退换货的数据-->
    <select id="getSuccessRefundList" resultType="com.wuliangit.shopos.dto.StoreRefundListDTO">
        SELECT refund_id,order_sn,refund_sn,member_name,goods_name,reason_info,refund_type
        FROM t_refund
        <where>
            seller_state = "CONSENT"
            <if test="searchKey != null and searchKey != '' ">
                and ( member_name like '%${searchKey}%' or goods_name like '%${searchKey}%')
            </if>
            <if test="type == ''">
                and ( refund_type = 'CHANGE_GOODS' or refund_type = 'REFUND_ALL')
            </if>
            <if test="type != ''">
                and refund_type = #{type}
            </if>
        </where>
        order by
        <if test="orderColumn != null and orderColumn !='' and orderType != null and orderType != '' ">
            ${orderColumn} ${orderType},
        </if>
        create_time desc
    </select>
</mapper>